# üßã FastAPI Bubble Tea Backend

–ë—ç–∫–µ–Ω–¥-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è Bubble Tea –∫–∞—Ñ–µ, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ **FastAPI** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **PostgreSQL**, **SQLAlchemy** –∏ **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é, –∞–≤–∞—Ç–∞—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ –∏ —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–∏.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üîê JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- üñºÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏
- üë§ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- üö™ –í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ (—É–¥–∞–ª–µ–Ω–∏–µ refresh —Ç–æ–∫–µ–Ω–∞)
- üó∫Ô∏è –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –≥–æ—Ä–æ–¥–∞ —Å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤
- üéÅ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–π (–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- üåê –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CORS (–¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º)

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ main.py                 # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ database.py             # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ PostgreSQL
‚îú‚îÄ‚îÄ models.py               # SQLAlchemy-–º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ promotions.py       # –†–æ—É—Ç —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º /promotions
‚îÇ   ‚îî‚îÄ‚îÄ upload_photo.py
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îú‚îÄ‚îÄ photos/             # –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ map/                # –ö–∞—Ä—Ç–∏–Ω–∫–∞ –∫–∞—Ä—Ç—ã –≥–æ—Ä–æ–¥–∞
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_database.py
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_models.py
‚îÇ   ‚îú‚îÄ‚îÄ promotions/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_promotions.py
‚îÇ   ‚îî‚îÄ‚îÄ main/
‚îÇ       ‚îú‚îÄ‚îÄ test_login.py
‚îÇ       ‚îú‚îÄ‚îÄ test_logout.py
‚îÇ       ‚îú‚îÄ‚îÄ test_map.py
‚îÇ       ‚îú‚îÄ‚îÄ test_profile.py
‚îÇ       ‚îú‚îÄ‚îÄ test_register.py
‚îÇ       ‚îî‚îÄ‚îÄ test_upload_photo.py
‚îú‚îÄ‚îÄ .env                    # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ pytest.ini              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
‚îî‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
```
---

## üìå –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```
–ú–µ—Ç–æ–¥   –ü—É—Ç—å            –û–ø–∏—Å–∞–Ω–∏–µ
POST	/register	    –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST	/login	        –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ access + refresh —Ç–æ–∫–µ–Ω–æ–≤
POST	/refresh	    –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞ –ø–æ refresh —Ç–æ–∫–µ–Ω—É
POST	/logout	        –í—ã—Ö–æ–¥ (—É–¥–∞–ª–µ–Ω–∏–µ refresh —Ç–æ–∫–µ–Ω–∞)
GET	    /me	            –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
PUT	    /me	            –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST	/upload-photo	–ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏
GET	    /map	        –ü–æ–ª—É—á–µ–Ω–∏–µ URL –∫–∞—Ä—Ç—ã –≥–æ—Ä–æ–¥–∞
GET	    /promotions	    –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–π
```
---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    üì¶ –í—Å–µ —Ç–µ—Å—Ç—ã –ª–µ–∂–∞—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ tests/.
    üß¨ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL, —É–∫–∞–∑–∞–Ω–Ω–∞—è –≤ .env.

    –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤(–Ω–∞—Ö–æ–¥—è—Å—å –≤ –ø–∞–ø–∫–µ backend):
        pytest

---

### ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    .env –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
    ```
    DATABASE_URL=postgresql://fastapi_user:mypassword123@localhost/fastapi_db
    SECRET_KEY=your_secret_key
    ALGORITHM=HS256
    ACCESS_TOKEN_EXPIRE_MINUTES=15
    ```

---

## üåê CORS
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ main.py —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º fastapi.middleware.cors.CORSMiddleware.

–í —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∑–∞–ø—Ä–æ—Å—ã —Å –ª—é–±—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
- allow_origins = ["*"]
‚ö†Ô∏è –í–∞–∂–Ω–æ: –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –≤–º–µ—Å—Ç–æ "*", –Ω–∞–ø—Ä–∏–º–µ—Ä:
- allow_origins = [
    "https://your-frontend-domain.com"
]
---

## üê≥ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∞–∫—Ü–∏–π
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å –≤—ã–±–æ—Ä–æ–º —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∞–∫—Ü–∏—è–º–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∞–∫—Ü–∏—è—Ö–∏
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ—á—Ç—ã

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–°–º. **requirements.txt**. –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- fastapi
- sqlalchemy
- psycopg2-binary
- python-jose
- passlib[bcrypt]
- python-dotenv
- pytest